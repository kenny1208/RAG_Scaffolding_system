{% extends "base.html" %} {% block content %}
<div class="row justify-content-center">
  <div class="col-md-8">
    <div class="card">
      <div class="card-body">
        <h2 class="card-title text-center mb-4">Learning Style Assessment</h2>
        <p class="lead text-center mb-4">
          此測評將根據Felder-Silverman學習風格模型來幫助您識別您的學習偏好。
        </p>

        <form id="survey-form">
          <!-- Active/Reflective Dimension -->
          <div class="mb-4">
            <h3 class="h5 mb-3">1..您傾向於如何學習新資訊?</h3>
            <div class="list-group">
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_1"
                  value="active"
                  required
                />
                我傾向於透過實作或討論來理解資訊。
              </label>
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_1"
                  value="reflective"
                  required
                />
                我傾向於先思考資訊，再進行實作。
              </label>
            </div>
          </div>

          <div class="mb-4">
            <h3 class="h5 mb-3">2.當您在進行團隊專案時，您通常會：</h3>
            <div class="list-group">
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_2"
                  value="active"
                  required
                />
                立即參與並貢獻想法。
              </label>
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_2"
                  value="reflective"
                  required
                />
                先聆聽並思考，再提出貢獻。
              </label>
            </div>
          </div>

          <!-- Sensing/Intuitive Dimension -->
          <div class="mb-4">
            <h3 class="h5 mb-3">3.當您學習新資訊時，您通常會偏好：</h3>
            <div class="list-group">
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_3"
                  value="sensing"
                  required
                />
                具體事實和實用例子。
              </label>
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_3"
                  value="intuitive"
                  required
                />
                抽象概念和理論。
              </label>
            </div>
          </div>

          <div class="mb-4">
            <h3 class="h5 mb-3">4.我發現學習：</h3>
            <div class="list-group">
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_4"
                  value="sensing"
                  required
                />
                循序漸進的步驟和實際應用。
              </label>
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_4"
                  value="intuitive"
                  required
                />
                與更廣泛的想法和創新相連的概念。
              </label>
            </div>
          </div>

          <!-- Visual/Verbal Dimension -->
          <div class="mb-4">
            <h3 class="h5 mb-3">5.我記憶資訊時，偏好以：</h3>
            <div class="list-group">
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_5"
                  value="visual"
                  required
                />
                圖片、圖表、圖示或示範。
              </label>
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_5"
                  value="verbal"
                  required
                />
                書面或口語的解釋。
              </label>
            </div>
          </div>

          <div class="mb-4">
            <h3 class="h5 mb-3">6.當您需要前往新地點時，您偏好：</h3>
            <div class="list-group">
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_6"
                  value="visual"
                  required
                />
                地圖或視覺指南。
              </label>
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_6"
                  value="verbal"
                  required
                />
                口語或書面指示。
              </label>
            </div>
          </div>

          <!-- Sequential/Global Dimension -->
          <div class="mb-4">
            <h3 class="h5 mb-3">7.當您解決問題時，您傾向於：</h3>
            <div class="list-group">
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_7"
                  value="sequential"
                  required
                />
                循序漸進地解決問題。
              </label>
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_7"
                  value="global"
                  required
                />
                先看到整體圖像，再解決問題。
              </label>
            </div>
          </div>

          <div class="mb-4">
            <h3 class="h5 mb-3">8.當您學習新主題時，您偏好：</h3>
            <div class="list-group">
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_8"
                  value="sequential"
                  required
                />
                專注於細節並逐步建立整體理解。
              </label>
              <label class="list-group-item">
                <input
                  class="form-check-input me-2"
                  type="radio"
                  name="question_8"
                  value="global"
                  required
                />
                先了解整體概念，再探索細節。
              </label>
            </div>
          </div>

          <div class="d-grid">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-check me-2"></i>
              提交評估
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("survey-form");

    form.addEventListener("submit", async function (e) {
      e.preventDefault();

      const dimensions = {
        active: 0,
        reflective: 0,
        sensing: 0,
        intuitive: 0,
        visual: 0,
        verbal: 0,
        sequential: 0,
        global: 0,
      };

      // Collect answers from all radio buttons
      const questions = [
        "question_1",
        "question_2",
        "question_3",
        "question_4",
        "question_5",
        "question_6",
        "question_7",
        "question_8",
      ];

      // Check if all questions are answered
      for (const questionName of questions) {
        const selected = document.querySelector(
          `input[name="${questionName}"]:checked`
        );
        if (!selected) {
          const questionNumber = questionName.replace("question_", "");
          alert(`Please answer question ${questionNumber}`);
          return;
        }

        // Count the selections for each dimension
        dimensions[selected.value]++;
      }

      // Determine dominant dimensions
      const learningStyle = {
        dimension1:
          dimensions.active > dimensions.reflective ? "active" : "reflective",
        dimension2:
          dimensions.sensing > dimensions.intuitive ? "sensing" : "intuitive",
        dimension3: dimensions.visual > dimensions.verbal ? "visual" : "verbal",
        dimension4:
          dimensions.sequential > dimensions.global ? "sequential" : "global",
      };

      try {
        const response = await fetch("{{ url_for('learning_style_survey') }}", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            felder_silverman_results: learningStyle,
          }),
        });

        if (response.ok) {
          const data = await response.json();
          if (data.redirect) {
            window.location.href = data.redirect;
          } else {
            window.location.href = "{{ url_for('pretest') }}";
          }
        } else {
          const data = await response.json();
          alert(data.error || "An error occurred");
        }
      } catch (error) {
        console.error("Error:", error);
        alert("An error occurred while submitting the survey");
      }
    });
  });
</script>
{% endblock %}
<!-- 註解-->
